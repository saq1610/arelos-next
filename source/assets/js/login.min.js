/* globals Nanobar, Postleaf */
$(function(){"use strict";var e=new Nanobar,t=$(".login-form").attr("data-redirect");$('[data-toggle="tooltip"]').tooltip({trigger:"hover"}),$(".login-form").on("submit",function(o){var s,a=this;switch(o.preventDefault(),Postleaf.template){case"login.recover":s=Postleaf.url("api/login/recover");break;case"login.reset":s=Postleaf.url("api/login/reset");break;default:s=Postleaf.url("api/login")}e.go(50),Postleaf.highlightErrors(a),$(".form-message").prop("hidden",!0),$.ajax({url:s,type:"POST",data:$(a).serialize()}).done(function(e){if(e.message&&$(".form-message").toggleClass("text-success",e.success).toggleClass("text-warning",!e.success).text(e.message).prop("hidden",!1),e.success){if("login.recover"===Postleaf.template)return void $(a).find(":input").prop("disabled",!0);location.href=t?t:Postleaf.adminUrl()}else Postleaf.highlightErrors(a,e.invalid),$(".login-form").velocity("stop",!0).velocity("callout.shake")}).always(function(){e.go(100)})})});